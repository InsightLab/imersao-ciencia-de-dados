define("modules/clean/cloud_docs/cloud_doc_api_client",["require","exports","tslib"],function(e,t,n){"use strict";function r(){return n.__awaiter(this,void 0,Promise,function(){var t;return n.__generator(this,function(r){switch(r.label){case 0:return[4,new Promise(function(t,n){e(["modules/clean/api_v2/user_client"],t,n)}).then(n.__importStar)];case 1:return t=r.sent().UserApiV2Client,[2,(new t).ns("cloud_docs")]}})})}function i(e,t){return n.__awaiter(this,void 0,Promise,function(){return n.__generator(this,function(n){switch(n.label){case 0:return[4,r()];case 1:return[2,n.sent().rpc("get_token",{cloud_doc_id:t},{subjectUserId:e})]}})})}function o(e,t,n,r){i(e,t).then(n,r)}function s(e,t){return n.__awaiter(this,void 0,Promise,function(){return n.__generator(this,function(n){switch(n.label){case 0:return[4,r()];case 1:return[2,n.sent().rpc("get_navigation_properties",{cloud_doc_id:t},{subjectUserId:e})]}})})}function a(e,t,n,r){s(e,t).then(n,r)}function c(e,t,i){return n.__awaiter(this,void 0,Promise,function(){return n.__generator(this,function(n){switch(n.label){case 0:return[4,r()];case 1:return[2,n.sent().rpc("preferred_editor_prompt/disable",{integration_name:t,preferred_editor_doc_type:i},{subjectUserId:e})]}})})}function u(e,t){return n.__awaiter(this,void 0,Promise,function(){return n.__generator(this,function(n){switch(n.label){case 0:return[4,r()];case 1:return[2,n.sent().rpc("pass_snackbar/get",{cloud_doc_id:t},{subjectUserId:e})]}})})}function l(e){return n.__awaiter(this,void 0,Promise,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,r()];case 1:return[2,t.sent().rpc("pass_snackbar/set",void 0,{subjectUserId:e})]}})})}function d(e){return n.__awaiter(this,void 0,Promise,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,r()];case 1:return[2,t.sent().rpc("signin_snackbar/get",void 0,{subjectUserId:e})]}})})}function _(e){return n.__awaiter(this,void 0,Promise,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,r()];case 1:return[2,t.sent().rpc("signin_snackbar/set",void 0,{subjectUserId:e})]}})})}function p(e){return n.__awaiter(this,void 0,Promise,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,r()];case 1:return[2,t.sent().rpc("admin_settings/get",void 0,{subjectUserId:e})]}})})}function f(e,t,i){return n.__awaiter(this,void 0,Promise,function(){return n.__generator(this,function(n){switch(n.label){case 0:return[4,r()];case 1:return[2,n.sent().rpc("get_preferred_editor_url",{file_id:t,file_ext:i},{subjectUserId:e})]}})})}function g(e,t,i){return n.__awaiter(this,void 0,Promise,function(){var o;return n.__generator(this,function(n){switch(n.label){case 0:return[4,r()];case 1:return o=n.sent(),[2,o.rpc("log_token_in_use",{cloud_doc_id:t,auth_token:i},{subjectUserId:e}).catch(function(){return new Promise(function(){return null})})]}})})}Object.defineProperty(t,"__esModule",{value:!0}),t.getCloudDocToken=o,t.getNavigationProperties=a,t.dismissPreferredEditorPrompt=c,t.getPassSnackbarAsync=u,t.setPassSnackbarAsync=l,t.getSignInSnackbarAsync=d,t.setSignInSnackbarAsync=_,t.getAdminSettings=p,t.getPreferredUrl=f,t.logTokenInUse=g}),define("modules/clean/cloud_docs/constants",["require","exports","tslib","external/lodash","modules/clean/filepath","modules/clean/static_urls","modules/core/i18n"],function(e,t,n,r,i,o,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importStar(r);var a,c,u;(function(e){e.PAPER="paper"})(t.PaperNewFileTypes||(t.PaperNewFileTypes={}));(function(e){e.PAPER="paper",e.PAPER_TEMPLATE="papert"})(t.PaperFileTypes||(t.PaperFileTypes={}));var l;(function(e){e.GOOGLE_DSS_DOC="gdoc",e.GOOGLE_DSS_SHEET="gsheet",e.GOOGLE_DSS_SLIDES="gslides"})(l=t.GoogleFileTypes||(t.GoogleFileTypes={}));var d;(function(e){e.SIMPLE_POINTER="dlink"})(d=t.PointerFileTypes||(t.PointerFileTypes={}));var _;(function(e){e.WORD="docx",e.EXCEL="xlsx",e.POWERPOINT="pptx"})(_=t.MicrosoftFileTypes||(t.MicrosoftFileTypes={}));(function(e){e.WORD="word",e.EXCEL="excel",e.POWERPOINT="powerpoint"})(t.MicrosoftEditors||(t.MicrosoftEditors={}));(function(e){e.HOME="new_file_menu_home",e.BROWSE="new_file_menu_browse"})(t.NewFileMenuFromType||(t.NewFileMenuFromType={})),t.isMicrosoftFileType=function(e){return r.values(_).includes(e)},t.isPointerFileType=function(e){return r.values(d).includes(e)},t.LOADING_PAGE_URL="/cloud_docs/loading",t.QueryParamBlackList={platform:!0,dc_open_id:!0,web_open_id:!0,ts:!0,fileid_gid:!0},t.DSS_TYPE_TO_OPEN_WITH_ICONS=(a={},a[l.GOOGLE_DSS_DOC]=o.static_url("/static/images/cloud_docs/gdoc-vfljy0OpJ.svg"),a[l.GOOGLE_DSS_SHEET]=o.static_url("/static/images/cloud_docs/gsheet-vflWVpJ8G.svg"),a[l.GOOGLE_DSS_SLIDES]=o.static_url("/static/images/cloud_docs/gslides-vflvsGNC8.svg"),a),t.DSS_TYPE_TO_TEXT=(c={},c[l.GOOGLE_DSS_DOC]=s._("Google Docs"),c[l.GOOGLE_DSS_SHEET]=s._("Google Sheets"),c[l.GOOGLE_DSS_SLIDES]=s._("Google Slides"),c),t.GOOGLE_DOC_SUPPORTED_EXTS=[".docx",".gdoc"],t.GOOGLE_SHEET_SUPPORTED_EXTS=[".xlsx",".gsheet"],t.GOOGLE_SLIDES_SUPPORTED_EXTS=[".pptx",".gslides"],t.DSS_TYPE_TO_SUPPORTED_EXTS=(u={},u[l.GOOGLE_DSS_DOC]=t.GOOGLE_DOC_SUPPORTED_EXTS,u[l.GOOGLE_DSS_SHEET]=t.GOOGLE_SHEET_SUPPORTED_EXTS,u[l.GOOGLE_DSS_SLIDES]=t.GOOGLE_SLIDES_SUPPORTED_EXTS,u),t.POINTER_EXTS=["web"],t.CLOUD_DOCS_EXTS=["paper","papert","web","gdoc","gsheet","gslides"],t.isCloudDocByExtension=function(e){return e.length>0&&"."===e[0]&&(e=e.substr(1)),t.CLOUD_DOCS_EXTS.includes(e.toLowerCase())},t.isPointerByExtension=function(e){return t.POINTER_EXTS.includes(i.file_extension(e))};(function(e){e.WEB="web",e.WEB_HOME="web_home",e.WEB_BROWSE="web_browse",e.UNKOWN="unknown"})(t.ActionSourceValue||(t.ActionSourceValue={}))});var __importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};define("modules/clean/react/app_actions/app_actions_menu",["require","exports","modules/clean/react/async/loadable"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExtensionsMenu=n.Loadable({loader:function(){return new Promise(function(t,n){e(["modules/clean/react/extensions/extensions_menu_component"],t,n)}).then(__importStar).then(function(e){return e.ExtensionsMenu})}}),t.UnconnectedExtensionsMenu=n.Loadable({loader:function(){return new Promise(function(t,n){e(["modules/clean/react/app_actions/unconnected_menu"],t,n)}).then(__importStar).then(function(e){return e.UnconnectedMenu})}})}),define("modules/clean/react/app_actions/category",["require","exports","modules/core/i18n"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={0:{displayName:n._("DEFAULT")},1:{displayName:n._("Send for signature"),developerDescription:n._("Send for signature")},2:{displayName:n._("PDF Editing"),developerDescription:n._("PDF editing")},3:{displayName:n._("View or Edit"),developerDescription:n._("View or edit")},4:{displayName:n._("Image Editing"),developerDescription:n._("Image editing")},5:{displayName:n._("Video comment"),developerDescription:n._("Video comment")},6:{displayName:n._("Send fax"),developerDescription:n._("Send fax")},7:{displayName:n._("Open With Cloud Doc"),developerDescription:n._("Open With Cloud Doc")},8:{displayName:n._("Edit"),developerDescription:n._("Video Editing")}};(function(e){function t(e){return r[e]||null}function n(e){var n=t(e);return n&&n.displayName}function i(e){var n=t(e);return n&&n.developerDescription||null}e.DEFAULT=0,e.ESIGNATURE=1,e.PDF_EDITING=2,e.VIEW_OR_EDIT=3,e.IMAGE_EDITING=4,e.VIDEO_COMMENT=5,e.SEND_FAX=6,e.OPEN_WITH_CLOUD_DOC=7,e.VIDEO_EDITING=8,e.getDisplayName=n,e.getDeveloperDescription=i})(t.Category||(t.Category={}))}),define("modules/clean/react/app_actions/feedback_modal",["require","exports","tslib","modules/clean/ajax","react","modules/clean/react/css","modules/clean/react/image","spectrum/button","modules/core/i18n","modules/clean/react/modal","spectrum/input","modules/clean/static_urls","modules/clean/filepath","modules/clean/file_store/utils","spectrum/dropdown_menu","dropins_sdk_refactor/dropins_sdk_internal","modules/constants/dropins"],function(e,t,n,r,i,o,s,a,c,u,l,d,_,p,f,g,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importStar(r),i=n.__importDefault(i),t.bugReport=c._("Report a problem"),t.suggestSomething=c._("Suggest something");var E="extensions-feedback",S=[t.bugReport,t.suggestSomething],m=(function(e){function o(n){var o=e.call(this,n)||this;return o.submitFeedback=function(){var e=o.state.detailsText;if(o.state.screenshotLinks.length>0){e+=" (Screenshot links: "+o.state.screenshotLinks.join("; ")+")"}if(o.state.category===t.bugReport){var n="[Extensions]"+o.state.subjectText;r.SilentBackgroundRequest({url:"/support_ajax/support_form",data:{user_email:o.props.user.email,subject_posted:n,details_posted:e}})}else r.SilentBackgroundRequest({url:"/aa/app_choice_feedback",subject_user:o.props.user.id,data:{ext:o.getFileExt(),other_suggested_apps:o.state.subjectText,comments:e,surface:o.props.surface||"unknown",menu_contents:o.props.visibleMenuItems?o.props.visibleMenuItems.join(", "):""}});o.setState({showThankYouModal:!0})},o.handleSubjectChanged=function(e){o.setState({subjectText:e.currentTarget.value.trim()})},o.handleDetailsChanged=function(e){o.setState({detailsText:e.currentTarget.value.trim()})},o.handleChooseFromDropbox=function(){g.Dropbox.choose({linkType:"preview",multiselect:!0,success:function(e){var t=e.map(function(e){return e.link}),n=e.map(function(e){return e.name});o.setState({screenshotLinks:t,attachmentNames:n})},extensions:["images","video"]})},o.isAnyFeedbackInput=function(){return o.state.subjectText.length>0||o.state.detailsText.length>0},o.handleCategoryChange=function(e){o.setState({category:e})},o.renderFeedbackModel=function(){return i.default.createElement(u.Modal,{className:E+"-modal",ariaLabel:"Feedback Modal",acceptButtonText:null,style:"clean",autoFocusPrimaryInput:!1,width:560},i.default.createElement("div",{className:E+"-inputs"},i.default.createElement("div",{className:E+"-title"},i.default.createElement("h1",{className:E+"-modal-header"},c._("Send feedback"))),i.default.createElement("div",{className:E+"-container"},i.default.createElement(f.DropdownMenu,{id:"select--category",className:E+"-category-selector",onSelection:o.handleCategoryChange},i.default.createElement(f.DropdownMenuButton,{fullWidth:!0,className:"menu-button"},o.state.category),i.default.createElement(f.Menu,null,o.renderCategoryItems())),i.default.createElement("label",{htmlFor:E+"-subject-input",className:E+"-label"},c._("Subject")),i.default.createElement(l.Input,{id:"subject-input",className:E+"-subject-input",onChange:o.handleSubjectChanged,"aria-label":c._("subject input")}),i.default.createElement("label",{htmlFor:E+"-details-input",className:E+"-label"},c._("Details")),i.default.createElement("textarea",{id:"details-input",className:E+"-details-input",onChange:o.handleDetailsChanged,"aria-label":c._("details input"),rows:4}),i.default.createElement(a.Button,{variant:"secondary",className:E+"-screenshot-button",onClick:o.handleChooseFromDropbox},c._("Add a screenshot")),o.renderSelectedScreenshot())),i.default.createElement("div",{className:E+"-action-bar"},i.default.createElement(a.Button,{variant:"secondary",className:"action-bar-cancel-button",onClick:o.props.onBack},c._("Cancel")),i.default.createElement("div",{className:E+"-action-bar-space"}),i.default.createElement(a.Button,{variant:"primary",className:"action-bar-submit-button",disabled:!o.isAnyFeedbackInput(),onClick:o.submitFeedback},c._("Submit"))))},o.renderThankYouModal=function(){return i.default.createElement(u.Modal,{className:E+"-thank-you-modal",ariaLabel:"Feedback Modal",acceptButtonText:null,style:"clean"},i.default.createElement(s.Image,{className:E+"-thank-you-image",alt:c._("Thank you"),src:d.static_url("/static/images/app_actions/feedback_comments-vfluWMAvS.png"),srcHiRes:d.static_url("/static/images/app_actions/feedback_comments@2x-vflWa-9nT.png")}),i.default.createElement("h1",{className:E+"-thank-you-header"},c._("Thanks for letting us know!")),i.default.createElement("h2",{className:E+"-thank-you-subtext"},c._("Your feedback will help make Dropbox even better.")))},o.state={category:t.bugReport,subjectText:"",detailsText:"",screenshotLinks:[],attachmentNames:[],showThankYouModal:!1},g.Dropbox.init({appKey:h.CHOOSER_APP_KEY}),o}return n.__extends(o,e),o.prototype.getFileExt=function(){var e=this.props.file;return void 0===e?null:p.isSharedFile(e)&&e.filename?_.file_extension(e.filename):p.isBrowseFile(e)&&e.ext?e.ext:""},o.prototype.renderCategoryItems=function(){var e=this;return S.map(function(t){return i.default.createElement(f.MenuItem,{value:t,key:t,selected:e.state.category===t},t)})},o.prototype.renderSelectedScreenshot=function(){return this.state.attachmentNames.map(function(e){return i.default.createElement("p",null,e)})},o.prototype.render=function(){return this.state.showThankYouModal?this.renderThankYouModal():this.renderFeedbackModel()},o})(i.default.Component);t.FeedbackModal=o.requireCssWithComponent(m,["/static/css/app_actions/index-vflcVf0Of.css"])}),define("modules/clean/react/app_actions/telemetry_client",["require","exports","tslib","modules/clean/logging/telemetry","modules/clean/logging/hive/schemas/web-app_actions_telemetry"],function(e,t,n,r,i){"use strict";function o(e){return new u(l,e)}function s(e){for(var t={},n=0,r=e;n<r.length;n++){t[r[n]]=!0}return t}function a(e){return d[e]?e:"__REDACTED__"}Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importStar(r);var c=(function(){function e(t,n){this.logger=t,this.context=n,this.sessionId=e.generateRandomId()}return e.generateRandomId=function(){return Math.random().toString(36).substring(2)},e.getCurrentTimestamp=function(){return(new Date).getTime()},e.prototype.event=function(t,r){var o=e.getCurrentTimestamp(),s=n.__assign({},this.context,r),a=new i.AppActionsTelemetryRow({telemetry_session_id:this.sessionId,event_name:t,event_start_ts:o,event_extras:JSON.stringify(s)});this.logger.log(a)},e})();t.Session=c;var u=(function(){function e(e,t){this.logger=e,this.context=t||{}}return e.prototype.session=function(e){var t=n.__assign({},this.context,e);return new c(this.logger,t)},e})();t.TelemetryClient=u;var l=new r.HiveLogger;t.createTelemetryClient=o;var d=s(["",".doc",".docx",".pdf",".dwg",".png",".jpg",".jpeg",".tiff",".m4v",".wmv",".mpg",".pptx",".xlsx",".pages",".numbers",".key"]);t.getPiiSafeExtension=a}),define("modules/clean/react/extensions/client",["require","exports","tslib","external/lodash","modules/clean/api_v2/user_client","modules/clean/react/extensions/feature_flags","modules/clean/react/extensions/file","modules/clean/cloud_docs/cloud_doc_api_client","modules/clean/cloud_docs/types"],function(e,t,n,r,i,o,s,a,c){"use strict";function u(e){return"app_id"in e}function l(){return _("",[])}function d(e,t){return e.priority&&t.priority?t.priority-e.priority:e.priority?-1:t.priority?1:e.description<t.description?-1:e.description>t.description?1:0}function _(e,t,n,r,i,o,s){return void 0===n&&(n=f.DISABLED),void 0===r&&(r={}),void 0===i&&(i={}),void 0===o&&(o={}),void 0===s&&(s={openWithGddSupported:!1}),{fileId:e,actionCategories:t,displayState:n,bylines:r,featureFlags:i,sharingServiceInfo:o,cloudDocsInfo:s}}function p(){return h||(h=new g(new i.UserApiV2Client)),h}Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importStar(r),t.isAppId=u;var f;(function(e){e[e.LOADING=0]="LOADING",e[e.DISABLED=1]="DISABLED",e[e.ENABLED=2]="ENABLED"})(f=t.DisplayState||(t.DisplayState={})),t.emptyExtensionsConfig=l,t.newExtensionsConfig=_;var g=(function(){function e(e){this.trackedFiles=new Map,this.loaded=!1,this.state={actionIdToAppAction:{},appActionAppIcons:{},appActionsEnabled:!1,bylines:{},categoryMapsByExt:{},featureFlags:{},sharingServiceInfo:{},cloudDocsInfo:{openWithGddSupported:!1}},this.parseCategoryActionGroupsFromState=r.memoize(function(e){var t={},n=function(n){if(e.categoryMapsByExt.hasOwnProperty(n)){var r=new Array;e.categoryMapsByExt[n].forEach(function(t,n){var i=t.map(function(t){return e.actionIdToAppAction[t]}).sort(d);r.push({categoryId:n,actions:i})}),t[n]=r}};for(var r in e.categoryMapsByExt)n(r);return t}),this.client=e}return e.prototype.getActionsForFile=function(e,t){return n.__awaiter(this,void 0,Promise,function(){var r;return n.__generator(this,function(n){switch(n.label){case 0:return[4,this.getActionsForFileBatch([e],t)];case 1:return r=n.sent(),[2,r[e.file_id]||l()]}})})},e.prototype.getActionsForFileBatch=function(e,t){return n.__awaiter(this,void 0,Promise,function(){var r;return n.__generator(this,function(n){switch(n.label){case 0:return[4,this.loadState(t)];case 1:return r=n.sent(),[2,this.getExtensionsConfigsForFiles(r,e)]}})})},e.prototype.getAppIcons=function(){return n.__assign({},this.state.appActionAppIcons)},e.prototype.refreshAppIcons=function(e){return n.__awaiter(this,void 0,Promise,function(){var t,r,i,o,s;return n.__generator(this,function(a){switch(a.label){case 0:t=void 0,r=this.iconRequest,a.label=1;case 1:return a.trys.push([1,6,,7]),r?[4,r]:[3,3];case 2:return t=a.sent(),[3,5];case 3:return i=Object.keys(this.state.appActionAppIcons),r=this.client.ns("app_actions").rpc("get_app_icons",{app_ids:i},{subjectUserId:e}),this.iconRequest=r,[4,r];case 4:t=a.sent(),a.label=5;case 5:return[3,7];case 6:return o=a.sent(),[3,7];case 7:return this.iconRequest=void 0,t&&(s=n.__assign({},this.state.appActionAppIcons),t.icons.forEach(function(e){s[e.app_id]=e.icon}),this.state=n.__assign({},this.state,{appActionAppIcons:s})),[2]}})})},e.prototype.getFeatureFlags=function(){return this.state.featureFlags},e.prototype.getLoadedState=function(){return this.loaded},e.prototype.updateLinkStateForAction=function(e,t){var r=this.state.actionIdToAppAction[e];if(r){var i=n.__assign({},this.state.actionIdToAppAction);i[e]=n.__assign({},r,{link_state:t}),this.state=n.__assign({},this.state,{actionIdToAppAction:i})}},e.prototype.extensionsConfigsForTrackedFiles=function(){var e=[];return this.trackedFiles.forEach(function(t){return e.push(t)}),this.getExtensionsConfigsForFiles(this.state,e)},e.prototype.loadState=function(e){return n.__awaiter(this,void 0,Promise,function(){var t,r,i;return n.__generator(this,function(n){switch(n.label){case 0:if(this.loaded)return[3,4];this.stateRequest||(this.stateRequest=this.fetchActions(e)),t=this.stateRequest,n.label=1;case 1:return n.trys.push([1,3,,4]),r=this,[4,this.stateRequest];case 2:return r.state=n.sent(),[3,4];case 3:return i=n.sent(),this.stateRequest===t&&(this.stateRequest=void 0),[3,4];case 4:return[2,this.state]}})})},e.prototype.getExtensionsConfigsForFiles=function(e,t){var n=this,r={},i=this.parseCategoryActionGroupsFromState(e);return t.forEach(function(t){var o=s.getFileExt(t),a=void 0;o&&(a=i[o]),r[t.file_id]=_(t.file_id,a||[],e.appActionsEnabled&&!t.is_dir?f.ENABLED:f.DISABLED,e.bylines,e.featureFlags,e.sharingServiceInfo,e.cloudDocsInfo),n.trackedFiles.set(t.file_id,t)}),r},e.prototype.fetchActions=function(e){return n.__awaiter(this,void 0,Promise,function(){var t,r,i,s,a,c,l,d,_,p,f;return n.__generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),t=this.client.ns("app_actions").rpc("get_actions_for_user",{},{subjectUserId:e}),[4,Promise.all([t,this.refreshSharingServiceInfo(e),this.getCloudDocsInfo(e)])];case 1:return r=n.sent(),i=r[0],s=r[1],a=r[2],c={},l={},i.actions.forEach(function(e){c[e.id]||(c[e.id]=e,l[e.app_id]=e.icon)}),d={},i.action_mapping.forEach(function(e){var t=e.matcher;if("extension"===t[".tag"]){var n=t.extension,r=new Map;e.action_ids.forEach(function(e){var t=c[e],n=r.get(t.category);n?n.push(t.id):(n=[t.id],r.set(t.category,n))}),d[n]=r}}),_={},i.bylines.forEach(function(e){var t=e.extension_id[".tag"];u(e.extension_id)&&(t=e.extension_id.app_id),_[t]=e.byline}),p=o.parseFeatureFlags(i.stormcrow_assignments),this.loaded=!0,[2,{appActionsEnabled:!0,actionIdToAppAction:c,appActionAppIcons:l,bylines:_,categoryMapsByExt:d,featureFlags:p,sharingServiceInfo:s,cloudDocsInfo:a}];case 2:if(f=n.sent(),f.error&&"feature_gated"===f.error[".tag"])return this.loaded=!0,[2,this.state];throw f;case 3:return[2]}})})},e.prototype.getCloudDocsInfo=function(e){return n.__awaiter(this,void 0,Promise,function(){var t,r,i;return n.__generator(this,function(n){switch(n.label){case 0:t={openWithGddSupported:!1},n.label=1;case 1:return n.trys.push([1,3,,4]),[4,a.getAdminSettings(e)];case 2:return r=n.sent(),t.openWithGddSupported=r.settings[c.GDD_INTEGRATION]===c.IntegrationSettingStatus.INTEGRATION_SETTING_ENABLED,[3,4];case 3:return i=n.sent(),i.error&&"not_in_team"===i.error[".tag"]&&(t.openWithGddSupported=!0),[3,4];case 4:return[2,t]}})})},e.prototype.getSharingServiceInfo=function(){return n.__assign({},this.state.sharingServiceInfo)},e.prototype.refreshSharingServiceInfo=function(e){return n.__awaiter(this,void 0,Promise,function(){var t,r,i;return n.__generator(this,function(o){switch(o.label){case 0:if(void 0!==this.sharingServiceReq)return[2,this.sharingServiceReq];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.client.ns("profile_services").rpc("list_services",void 0,{subjectUserId:e})];case 2:return t=o.sent(),r={},t.services.forEach(function(e){r[e.service_type[".tag"]]=e}),this.state=n.__assign({},this.state,{sharingServiceInfo:r}),[2,r];case 3:return i=o.sent(),this.sharingServiceReq=void 0,[2,{}];case 4:return[2]}})})},e})();t.Client=g;var h;t.getExtensionsClient=p}),define("modules/clean/react/extensions/connect_flow",["require","exports","tslib","modules/clean/integrations/link_service","modules/clean/integrations/log_event","deep-integrations/platform/log_event","deep-integrations/instrumentation/common_context","deep-integrations/instrumentation/constants","deep-integrations/instrumentation/connect_service_flow_wrapper"],function(e,t,n,r,i,o,s,a,c){"use strict";function u(e,t){return new Promise(function(n){return t({user:e,onRefresh:n})})}function l(e,t){return t in e&&"is_connected"===e[t].connection_state[".tag"]}function d(e,t,d,_,p,f){return n.__awaiter(this,void 0,Promise,function(){var g,h,E,S,m;return n.__generator(this,function(n){switch(n.label){case 0:if(l(t,_))return[2,!0];g=o.withDefaults(i.createIntegrationsActionsLogger().logEvent,{extra:s.getCommonContextExtra({serviceList:Object.keys(t).map(function(e){return t[e]})})}),h=t[_],h&&g(c.buildStartEvent(h,p,a.InstrConnectServiceFlowOutcome.Connected)),n.label=1;case 1:return n.trys.push([1,4,,5]),[4,r.linkService(e.id,_,f)];case 2:return n.sent(),[4,u(e,d)];case 3:return E=n.sent(),S=l(E,_),h&&g(S?c.buildEndEvent(h,p,a.InstrConnectServiceFlowOutcome.Connected,a.InstrConnectServiceFlowOutcome.Connected):c.buildEndEvent(h,p,a.InstrConnectServiceFlowOutcome.Connected,a.InstrConnectServiceFlowOutcome.Error)),[2,S];case 4:throw m=n.sent(),h&&g(c.buildEndEvent(h,p,a.InstrConnectServiceFlowOutcome.Connected,a.InstrConnectServiceFlowOutcome.Error,{error:JSON.stringify(m)})),m;case 5:return[2]}})})}function _(e,t,n,r,i,o,s){d(e,t,n,"zoom",o,s).then(function(e){e&&i(r)})}function p(t,r,i,o,s,a){var c=this;d(t,r,i,"slack_dropbox",s,a).then(function(r){return n.__awaiter(c,void 0,void 0,function(){var i;return n.__generator(this,function(s){switch(s.label){case 0:return r?[4,new Promise(function(t,n){e(["modules/clean/integrations/send_to_slack"],t,n)}).then(n.__importStar)]:[3,2];case 1:i=s.sent().showSendToSlackModal,i(t,o),s.label=2;case 2:return[2]}})})})}function f(t,r,i,o,s,a){var c=this;d(t,r,i,"trello",s,a).then(function(r){return n.__awaiter(c,void 0,void 0,function(){var i;return n.__generator(this,function(s){switch(s.label){case 0:return r?[4,new Promise(function(t,n){e(["modules/clean/integrations/share_to_trello"],t,n)}).then(n.__importStar)]:[3,2];case 1:i=s.sent().showShareToTrelloModal,i(t,o),s.label=2;case 2:return[2]}})})})}Object.defineProperty(t,"__esModule",{value:!0}),t.presentInZoomFlow=_,t.shareInSlackFlow=p,t.shareInTrelloFlow=f}),define("modules/clean/react/extensions/data/action_creators",["require","exports","tslib","modules/clean/react/extensions/client","modules/clean/react/extensions/data/types","modules/clean/integrations/data/actions"],function(e,t,n,r,i,o){"use strict";function s(e){var t=e.onRefresh;return function(e,n,r){var s=t&&function(e){"fulfilled"===e.state?t(i.convertToSharingServiceInfo(e.value)):t()};o.fetchListServices(s)(e,n,r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.updateExtensionConfigWithNewFiles=function(e){var o=e.files,s=e.user;return function(e){return n.__awaiter(this,void 0,void 0,function(){var a,c,u;return n.__generator(this,function(n){switch(n.label){case 0:return[4,r.getExtensionsClient().getActionsForFileBatch(o,s.id)];case 1:return a=n.sent(),e(t.setExtensionsFeatureFlags({featureFlags:r.getExtensionsClient().getFeatureFlags()})),c=r.getExtensionsClient().getAppIcons(),e({type:i.ActionTypes.REFRESH_ICONS,payload:{icons:c}}),u=r.getExtensionsClient().getSharingServiceInfo(),e({type:i.ActionTypes.SET_SHARING_SERVICE_INFO_STATE,payload:{sharingServiceInfo:u}}),e({type:i.ActionTypes.UPDATE_EXTENSIONS_CONFIG_WITH_NEW_FILES,payload:{fileExtensionsConfigs:a}}),e(t.setLoadedState({clientLoaded:r.getExtensionsClient().getLoadedState()})),[2]}})})}},t.setExtensionsFeatureFlags=function(e){var t=e.featureFlags;return{type:i.ActionTypes.SET_EXTENSIONS_FEATURE_FLAGS,payload:{featureFlags:t}}},t.setLoadedState=function(e){var t=e.clientLoaded;return{type:i.ActionTypes.SET_LOADED_STATE,payload:{clientLoaded:t}}},t.refreshAppIcons=function(e){var t=e.user;return function(e){return n.__awaiter(this,void 0,void 0,function(){var o;return n.__generator(this,function(n){switch(n.label){case 0:return[4,r.getExtensionsClient().refreshAppIcons(t.id)];case 1:return n.sent(),o=r.getExtensionsClient().getAppIcons(),e({type:i.ActionTypes.REFRESH_ICONS,payload:{icons:o}}),[2]}})})}},t.updateLinkState=function(e){var t=e.actionId,o=e.linkState;return function(e){return n.__awaiter(this,void 0,void 0,function(){var s,a;return n.__generator(this,function(n){switch(n.label){case 0:return[4,r.getExtensionsClient()];case 1:return s=n.sent(),s.updateLinkStateForAction(t,o),a=s.extensionsConfigsForTrackedFiles(),e({type:i.ActionTypes.UPDATE_EXTENSIONS_CONFIG_WITH_NEW_FILES,payload:{fileExtensionsConfigs:a}}),[2]}})})}},t.refreshSharingServiceInfo=function(e){var t=e.user,o=e.onRefresh;return function(e){return n.__awaiter(this,void 0,void 0,function(){var s,a,c;return n.__generator(this,function(n){switch(n.label){case 0:return s=r.getExtensionsClient(),[4,s.refreshSharingServiceInfo(t.id)];case 1:return n.sent(),[4,r.getExtensionsClient().getSharingServiceInfo()];case 2:return a=n.sent(),o&&o(a),e({type:i.ActionTypes.SET_SHARING_SERVICE_INFO_STATE,payload:{sharingServiceInfo:a}}),c=s.extensionsConfigsForTrackedFiles(),e({type:i.ActionTypes.UPDATE_EXTENSIONS_CONFIG_WITH_NEW_FILES,payload:{fileExtensionsConfigs:c}}),[2]}})})}},t.refreshSharingServiceInfoAdapter=s,t.setInDownloadInterceptFlow=function(e){var t=e.inDownloadInterceptFlow;return{type:i.ActionTypes.SET_IN_DOWNLOAD_INTERCEPT_FLOW,payload:{inDownloadInterceptFlow:t}}}}),define("modules/clean/react/extensions/data/reducer",["require","exports","tslib","modules/clean/react/extensions/data/types"],function(e,t,n,r){"use strict";function i(e,n){switch(void 0===e&&(e=t.defaultExtensionsState),n.type){case r.ActionTypes.UPDATE_EXTENSIONS_CONFIG_WITH_NEW_FILES:return o(e,n);case r.ActionTypes.SET_EXTENSIONS_FEATURE_FLAGS:return s(e,n);case r.ActionTypes.REFRESH_ICONS:return a(e,n);case r.ActionTypes.SET_LOADED_STATE:return c(e,n);case r.ActionTypes.SET_SHARING_SERVICE_INFO_STATE:return u(e,n);case r.ActionTypes.SET_IN_DOWNLOAD_INTERCEPT_FLOW:return l(e,n)}return e}Object.defineProperty(t,"__esModule",{value:!0}),t.defaultExtensionsState={fileExtensionsConfigs:{},featureFlags:{},appIcons:{},clientLoaded:!1,sharingServiceInfo:{},inDownloadInterceptFlow:!1};var o=function(e,t){var r=t.payload.fileExtensionsConfigs;return n.__assign({},e,{fileExtensionsConfigs:n.__assign({},e.fileExtensionsConfigs,r)})},s=function(e,t){var r=t.payload.featureFlags;return n.__assign({},e,{featureFlags:r})},a=function(e,t){var r=t.payload.icons;return n.__assign({},e,{appIcons:r})},c=function(e,t){var r=t.payload.clientLoaded;return n.__assign({},e,{clientLoaded:r})},u=function(e,t){var r=t.payload.sharingServiceInfo;return n.__assign({},e,{sharingServiceInfo:r})},l=function(e,t){var r=t.payload.inDownloadInterceptFlow;return n.__assign({},e,{inDownloadInterceptFlow:r})};t.extensionsReducer=i}),define("modules/clean/react/extensions/data/selectors",["require","exports","modules/clean/redux/namespaces","modules/clean/redux/selectors","modules/clean/react/extensions/data/reducer","modules/clean/react/extensions/client","modules/clean/integrations/data/selectors","modules/clean/react/extensions/data/types"],function(e,t,n,r,i,o,s,a){"use strict";function c(e,n){return t.getExtensionsState(e).fileExtensionsConfigs[n]||o.emptyExtensionsConfig()}Object.defineProperty(t,"__esModule",{value:!0}),t.getExtensionsState=function(e){return r.getStateAtNamespace(e,n.EXTENSIONS_NAMESPACE_KEY)||i.defaultExtensionsState},t.fileExtensionsConfigs=function(e){return t.getExtensionsState(e).fileExtensionsConfigs},t.getFeatureFlags=function(e){return t.getExtensionsState(e).featureFlags},t.getConfigForFile=c,t.getAppIcons=function(e){return t.getExtensionsState(e).appIcons},t.isLoaded=function(e){return t.getExtensionsState(e).clientLoaded},t.sharingServiceInfo=function(e){return t.getExtensionsState(e).sharingServiceInfo},t.getSharingServiceInfoAdapter=function(e){var t=s.getListServicesInfo(e).latestListServicesResult;return t&&a.convertToSharingServiceInfo(t)},t.inDownloadInterceptFlow=function(e){return t.getExtensionsState(e).inDownloadInterceptFlow}}),define("modules/clean/react/extensions/data/store",["require","exports","tslib","external/lodash","modules/clean/react/extensions/data/action_creators","modules/clean/redux/store","modules/clean/redux/namespaces","modules/clean/react/extensions/data/reducer","modules/clean/integrations/data/store"],function(e,t,n,r,i,o,s,a,c){"use strict";function u(e,n){var r=t.getStore();return c.initStoreForIntegration(e.id),n&&r.dispatch(i.updateExtensionConfigWithNewFiles({user:e,files:n})),r}Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importStar(r),t.getStore=r.once(function(){var e;return c.registerReducersForIntegration(),o.getStoreAndRegisterReducers((e={},e[s.EXTENSIONS_NAMESPACE_KEY]=a.extensionsReducer,e))}),t.initializeStore=u}),define("modules/clean/react/extensions/data/types",["require","exports"],function(e,t){"use strict";function n(e){try{var t={};return e.services.forEach(function(e){t[e.service_type[".tag"]]=e}),t}catch(e){}return{}}Object.defineProperty(t,"__esModule",{value:!0});(function(e){e.UPDATE_EXTENSIONS_CONFIG_WITH_NEW_FILES="EXTENSIONS/UPDATE_EXTENSIONS_CONFIG_WITH_NEW_FILES",e.SET_EXTENSIONS_FEATURE_FLAGS="EXTENSIONS/SET_EXTENSIONS_FEATURE_FLAGS",e.REFRESH_ICONS="EXTENSIONS/REFRESH_ICONS",e.SET_LOADED_STATE="EXTENSIONS/SET_LOADED_STATE",e.UPDATE_LINK_STATE="EXTENSIONS/UPDATE_LINK_STATE",e.SET_SHARING_SERVICE_INFO_STATE="EXTENSIONS/SET_SHARING_SERVICE_INFO_STATE",e.SET_IN_DOWNLOAD_INTERCEPT_FLOW="EXTENSIONS/SET_IN_DOWNLOAD_INTERCEPT_FLOW"})(t.ActionTypes||(t.ActionTypes={}));(function(e){e.PrimaryButton="primary_button",e.SecondaryButton="secondary_button",e.SidebarLink="sidebar_link",e.SidebarPrimaryButton="sidebar_primary_button",e.CollapsedButton="collapsed_button"})(t.TriggerType||(t.TriggerType={})),t.convertToSharingServiceInfo=n}),define("modules/clean/react/extensions/feature_flags",["require","exports"],function(e,t){"use strict";function n(){var e=[];for(var t in i)if(i.hasOwnProperty(t)){var n=t;e.push([n,i[n]])}return e}function r(e){var t={}
;return n().forEach(function(n){var r=n[0],i=n[1],o=e[i];void 0!==o&&(t[r]=o)}),t}Object.defineProperty(t,"__esModule",{value:!0});var i={testFlag:"test_gated_feature",expBigTooltipText:"extensions_edu_tooltip_text",expSplitShareBtn:"extensions_split_share_btn",expGmailAction:"extensions_gmail_action",expWhatsAppAction:"extensions_whats_app_action",expOutlookAction:"extensions_outlook_action",expCommAppValue:"extensions_comm_app_value",expDownloadIntercept:"extensions_download_intercept",expPersonalization:"extensions_personalization"};t.parseFeatureFlags=r}),define("modules/clean/react/extensions/file",["require","exports","modules/clean/filepath"],function(e,t,n){"use strict";function r(e){return void 0!==e.ext}function i(e){return void 0!==e.fq_path}function o(e){return void 0!==e.filename}function s(e){return r(e)?e.ext:i(e)?"."+n.file_extension(n.filename(e.fq_path)):o(e)?"."+n.file_extension(e.filename):void 0}Object.defineProperty(t,"__esModule",{value:!0}),t.hasExt=r,t.hasFqPath=i,t.hasFilename=o,t.getFileExt=s});var __importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};define("modules/clean/react/extensions/split_share_button",["require","exports","modules/clean/react/async/loadable"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SplitShareButton=n.Loadable({loader:function(){return new Promise(function(t,n){e(["modules/clean/react/extensions/split_share_button_component"],t,n)}).then(__importStar).then(function(e){return e.SplitShareButton})}})}),define("modules/clean/react/extensions/tooltips",["require","exports","modules/core/i18n"],function(e,t,n){"use strict";function r(e){switch(e){case"open_with_edu":return{".tag":e};case"split_share_edu":return{".tag":e};case"edit_experiment_image":return{".tag":e};case"edit_experiment_pdf":return{".tag":e};case"download_intercept_image":return{".tag":e};case"download_intercept_pdf":return{".tag":e};case"upload_intercept_image":return{".tag":e};case"upload_intercept_pdf":return{".tag":e};case"desktop_notification":return{".tag":e};case"other":return{".tag":e}}}function i(e,t){return s.filter(function(n){return o[n]({extensionsConfig:e,fileExt:t})})}Object.defineProperty(t,"__esModule",{value:!0}),t.tooltipFromName=r;var o={open_with_edu:function(e){return e.extensionsConfig.actionCategories.length>0},split_share_edu:function(e){return"ON"===e.extensionsConfig.featureFlags.expSplitShareBtn},download_intercept_image:function(e){var t=e.extensionsConfig,n=e.fileExt;return t.actionCategories.length>0&&"ON"===t.featureFlags.expDownloadIntercept&&[".jpg",".png",".jpeg"].indexOf(n)!==-1},download_intercept_pdf:function(e){var t=e.extensionsConfig,n=e.fileExt;return t.actionCategories.length>0&&"ON"===t.featureFlags.expDownloadIntercept&&".pdf"===n},upload_intercept_image:function(){return!1},upload_intercept_pdf:function(){return!1},edit_experiment_pdf:function(){return!1},edit_experiment_image:function(){return!1},desktop_notification:function(){return!1},other:function(){return!1}},s=["open_with_edu","split_share_edu","download_intercept_pdf","download_intercept_image","desktop_notification"];t.allowedTooltipsForConfig=i;(function(e){e.TOOLTIP_CONFIGS={open_with_edu:{tooltipTitle:n._("Do more with your files"),tooltipMessage:n._("Work on this file in other apps. Updates you make will automatically save back to Dropbox.")},download_intercept_pdf:{tooltipTitle:n._("No need to download"),tooltipMessage:n._("Edit, annotate, fax, or sign PDFs in your browser.")}},e.EDU_SPLIT_SHARE_MAP={CONTROL:{tooltipTitle:n._("Extend the power of Dropbox"),tooltipMessage:n._("Now you can send files to Slack or present in Zoom without leaving Dropbox.")}}})(t.EduTooltipExperiment||(t.EduTooltipExperiment={}))}),define("modules/clean/react/extensions/utils",["require","exports"],function(e,t){"use strict";function n(e,n){var r=!!e.featureFlags.expSplitShareBtn&&("ON"===e.featureFlags.expSplitShareBtn||"ON_SHOW_INVITE"===e.featureFlags.expSplitShareBtn),i=!n.is_dir&&(t.isSlackAvailable(e.sharingServiceInfo)||t.isZoomAvailable(e.sharingServiceInfo)),o=t.isTrelloAvailable(e.sharingServiceInfo);return r&&(i||o)}function r(e,n){return!n.is_dir&&(t.isSlackAvailable(e.sharingServiceInfo)||t.isZoomAvailable(e.sharingServiceInfo))&&!!e.featureFlags.expSplitShareBtn&&"CONTROL"===e.featureFlags.expSplitShareBtn}function i(e,t){return t in e&&"enabled"===e[t].service_availability[".tag"]}Object.defineProperty(t,"__esModule",{value:!0}),t.shouldShowSplitShare=n,t.shouldShowOpenWithShare=r,t.isSlackAvailable=function(e){return i(e,"slack_dropbox")},t.isZoomAvailable=function(e){return i(e,"zoom")},t.isTrelloAvailable=function(e){return i(e,"trello")}});
//# sourceMappingURL=pkg-extensions.min.js-vflFdOWgk.map