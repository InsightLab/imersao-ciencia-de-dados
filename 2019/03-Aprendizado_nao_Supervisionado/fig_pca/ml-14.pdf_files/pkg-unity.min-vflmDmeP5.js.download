define("modules/clean/unity/check_file_cache",["require","exports","modules/clean/unity/features"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var _=(function(){function e(){}return e.is_cached_and_locally_available=function(e,t){var _=this._cache[n.UnityFeatures.server_path(e,t)];return null!=_&&_.is_locally_available},e.get=function(e,t){return this._cache[n.UnityFeatures.server_path(e,t)]},e.set=function(e,t){this._cache[e]=t},e.set_batch=function(e){Object.assign(this._cache,e)},e.clear=function(){this._cache={}},e._cache={},e})(),o=_;n.UnityFeatures.isUnitySupported()||(o=void 0),t.default=o}),define("modules/clean/unity/connection",["require","exports","tslib","jquery","modules/clean/ajax","modules/clean/unity/connection_error","modules/clean/unity/logger","modules/clean/unity/versions","modules/clean/unity/websocket_config","modules/clean/unity/web_socket","modules/clean/viewer","modules/constants/unity","modules/core/exception","modules/core/uri"],function(e,t,n,_,o,i,r,s,a,c,l,u,d,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),_=n.__importDefault(_),o=n.__importStar(o),r=n.__importDefault(r),s=n.__importDefault(s),u=n.__importStar(u),d=n.__importStar(d);var f;(function(e){e.CONNECTION_OPENED="CONNECTION_OPENED",e.VERSION_CHECK="VERSION_CHECK",e.FETCHING_NONCE="FETCHING_NONCE",e.NONCE_RETURNED_TO_CLIENT="NONCE_RETURNED_TO_CLIENT",e.HANDSHAKE_COMPLETED="HANDSHAKE_COMPLETED"})(f=t.LastCompletedSecurityHandshakeStep||(t.LastCompletedSecurityHandshakeStep={}));var p;(function(e){e.PENDING="PENDING",e.ESTABLISHED="ESTABLISHED",e.CLOSED="CLOSED",e.RETRYING="RETRYING"})(p=t.ConnectionState||(t.ConnectionState={}));var E;(function(e){e.SECURE_PERMISSION="secure",e.INSECURE_WEB_PERMISSION="insecure_web",e.INSECURE_CLIENT_PERMISSION="insecure_client",e.INSECURE_PERMISSION="insecure"})(E=t.Permissions||(t.Permissions={}));t.MIN_PORT=17600,t.MAX_PORT=17602;var S=(function(){function e(){var e=this;this.client_version=null,this.logger=new r.default,this._on_open_callbacks=[],this._on_open_failed_callbacks=[],this._on_close_callbacks=[],this._pending_callbacks=[],this._response_callbacks={},this._webSocket=null,this._port=null,this._active_ports={},this._connection_state=p.PENDING,this._current_message_id=1,this._permission_level=null,this._on_close=function(t){return function(n){[1e3,1001,1005,1006].includes(n.code)||e.logger.report_event("unity_failure",{message:"WebSocket closed. Code: "+n.code+". Reason: "+n.reason,port:t}),e._close_port(t)}},this._on_error=function(t){return function(n){e.logger.report_event("unity_failure",{message:"WebSocket error. Message: "+n.data,port:t}),e._close_port(t)}},this._set_connection_state=function(t){if(t!==e._connection_state){var n=e._connection_state;if(d.assert(n!==p.CLOSED,"Shouldn't unclose a closed connection."),e._connection_state=t,t===p.ESTABLISHED){d.assert(e._is_connection_in_progress(n),"Can only establish from pending or retrying."),e.logger.report_event("handshake_complete"),n===p.PENDING&&e._on_open_callbacks.forEach(function(e){return e()});for(var _=[];e._pending_callbacks.length;){var o=e._pending_callbacks.pop(),r=o.callback,s=o.error_callback;e.is_ready()?_.push(r()):_.push("function"==typeof s?s(i.UnityConnectionError.UNEXPECTED_ERROR):void 0)}return _}if(t!==p.RETRYING){if(t===p.CLOSED){n===p.PENDING?(e.logger.report_event("connection_not_established"),e._on_open_failed_callbacks.forEach(function(e){return e()})):n===p.RETRYING?(e.logger.report_event("connection_terminated"),e._on_close_callbacks.forEach(function(e){return e()})):d.assert(!1,"CONNECTION_CLOSED can only be set from PENDING or RETRYING");for(var a=[];e._pending_callbacks.length;){var s=e._pending_callbacks.pop().error_callback;a.push("function"==typeof s?s(i.UnityConnectionError.CONNECTION_CLOSED):void 0)}return a}return d.assert(!1,"Changing connection_state to CONNECTION_PENDING not supported.")}}},this._on_message=function(t){return function(n){var _=JSON.parse(n.data);if(!_.func||!_.header||!_.header.message_id||void 0===_.header.should_respond)return void e._terminate_handshake(t.ws,"Malformed message from client.",{message:n.data});if(_.header.log_data&&e.logger.update(_.header.log_data),e.logger.update({port:t.port}),"response"===_.func)e._on_response(_.header.message_id,_.data);else{var o=e._routes[_.func];if(null==o)return void e._terminate_handshake(t.ws,"Unknown function.",{function:_.func});var i=e.is_ready()?o(_.data):o(t,_.data);_.header&&_.header.should_respond&&e.send("response",i,null,null,_.header.message_id)}}},this._on_response_timeout=function(t){return function(){var n=e._response_callbacks[t].error_callback;delete e._response_callbacks[t],n&&n(i.UnityConnectionError.CONNECTION_TIMEOUT)}},this._check_unity_version=function(t,n){if(t.state!==f.CONNECTION_OPENED)return void e._terminate_handshake(t.ws,"Handshake version check at wrong time of protocol.");if(t.state=f.VERSION_CHECK,t.client_version=n.client_version,n.client_version<s.default.UNITY_HANDSHAKE)return void e._terminate_handshake(t.ws,"Client version is too old.");var _=e._web_has_auth();return n.client_version<s.default.PERMISSION_LEVELS&&!_?void e._terminate_handshake(t.ws,"Client version is too old to support insecure web connections."):(e.logger.report_event("handshake_version_check"),n.client_version>=s.default.PERMISSION_LEVELS?e._send_with_ws(t.ws,"initiate_handshake",{secure_web:_}):e._send_with_ws(t.ws,"initiate_handshake"))},this._fetch_unity_nonce=function(t,n){t.state===f.VERSION_CHECK?(t.state=f.FETCHING_NONCE,e.logger.report_event("handshake_fetch_nonce"),e._retrieve_unity_nonce(t,n.nonce_key)):e._terminate_handshake(t.ws,"Fetch Unity nonce at wrong time of protocol.")},this._complete_handshake=function(t,n){if(t.state===f.NONCE_RETURNED_TO_CLIENT&&n.is_success)if(t.state=f.HANDSHAKE_COMPLETED,e._connection_state===p.CLOSED)e._terminate_handshake(t.ws,"No more handshakes are allowed to complete.");else if(null!=e._webSocket){var _="Only one Unity handshake can succeed! There's likely a MITM attack, so close all connections.";e._terminate_handshake(t.ws,_),e._terminate_handshake(e._webSocket,_),e.client_version=null,e._webSocket=null,e._port=null,e._set_connection_state(p.CLOSED)}else e.client_version=t.client_version,e._webSocket=t.ws,e._port=t.port,e._set_connection_state(p.ESTABLISHED);else e._terminate_handshake(t.ws,"Unable to complete handshake.")},this._routes={check_unity_version:this._check_unity_version,fetch_unity_nonce:this._fetch_unity_nonce,complete_handshake:this._complete_handshake}}return e.prototype.start=function(){a.WebSocketConfig.canUnityConnect()&&c.UnityWebSocket.load_flash_policy_if_needed()?this._attempt_handshake():(this._set_connection_state(p.CLOSED),this.logger.report_event("unity_failure",{message:"WebSocket creation failed. Not able to create web socket."}))},e.prototype._attempt_handshake=function(){for(var e=t.MIN_PORT;e<=t.MAX_PORT;e++)try{this._active_ports[e]=!0;var n={scheme:"ws",authority:"127.0.0.1:"+e.toString(),path:"/ws"},_=c.UnityWebSocket.create(new h.URI(n).toString());_.onmessage=this._on_message({ws:_,port:e,state:f.CONNECTION_OPENED,client_version:null,client_has_auth:null}),_.onclose=this._on_close(e),_.onerror=this._on_error(e)}catch(t){this.logger.report_event("unity_failure",{message:"WebSocket creation failed. Message: "+t.message,error_name:t.name,port:e}),this._set_connection_state(p.CLOSED)}this.logger.report_event("handshake_started")},e.prototype._close_port=function(e){if(e in this._active_ports&&(delete this._active_ports[e],_.default.isEmptyObject(this._active_ports)))return this._connection_state===p.ESTABLISHED?this._retry_connection():this._set_connection_state(p.CLOSED)},e.prototype._retry_connection=function(){return this.logger.report_event("connection_retrying"),this._set_connection_state(p.RETRYING),this.client_version=this._webSocket=this._port=null,this._attempt_handshake()},e.prototype.send=function(e,t,n,_,o){if(void 0===t&&(t=null),void 0===n&&(n=null),void 0===_&&(_=null),void 0===o&&(o=null),this._webSocket)return this._send_with_ws(this._webSocket,e,t,n,_,o)},e.prototype._send_with_ws=function(e,t,n,_,o,r){if(void 0===n&&(n=null),void 0===_&&(_=null),void 0===o&&(o=null),void 0===r&&(r=null),null==r&&(r=this._current_message_id,d.assert(this._current_message_id%2===1,"Web-initiated message_ids should remain odd"),this._current_message_id+=2),null!==_){var s=window.setTimeout(this._on_response_timeout(r),5e3);this._response_callbacks[r]={response_callback:_,error_callback:o,timeout_id:s}}var a={func:t,header:{message_id:r,should_respond:null!==_,log_data:this.logger.get_log_data_for_client()}};null!=n&&(a.data=n);try{return e.send(JSON.stringify(a))}catch(e){this.logger.report_event("unity_failure",{message:"WebSocket send failed. Message: "+e.message,error_name:e.name}),o&&o(i.UnityConnectionError.COULD_NOT_SEND)}},e.prototype._on_response=function(e,t){if(e in this._response_callbacks){var n=this._response_callbacks[e],_=n.response_callback,o=n.timeout_id;delete this._response_callbacks[e],window.clearTimeout(o),_&&_(t)}},e.prototype._web_has_auth=function(){return l.Viewer.get_viewer().is_signed_in},e.prototype._retrieve_unity_nonce=function(t,n){var _=this;return o.WebRequest({url:new h.URI({path:"/retrieve_unity_nonce"}),dataType:"json",data:{nonce_key:n},success:function(n){switch(n.status){case"OK":if(t.state=f.NONCE_RETURNED_TO_CLIENT,(null===t.client_version||t.client_version>=s.default.PORT_CHECK)&&(d.assert(n.message.client_port,"Port check must happen in version "+t.client_version),n.message.client_port!==t.port))return void _._terminate_handshake(t.ws,"Mismatched ports.",{client_port:n.message.client_port,web_port:t.port});t.client_has_auth=n.message.client_has_auth;var o=_._web_has_auth();return t.client_has_auth&&o?_._permission_level=e.SECURE_PERMISSION:(d.assert(null===t.client_version||t.client_version>=s.default.PERMISSION_LEVELS,"Insecure connections only supported by client_version >= "+s.default.PERMISSION_LEVELS+"."),_._permission_level=t.client_has_auth?e.INSECURE_WEB_PERMISSION:o?e.INSECURE_CLIENT_PERMISSION:e.INSECURE_PERMISSION),_.logger.update({unity_permission_level:_._permission_level}),_.logger.report_event("handshake_nonce_sent_to_unity_server"),_._send_with_ws(t.ws,"verify_unity_nonce",{nonce:n.message.nonce});case"MISMATCHED_USER_IDS":return _._terminate_handshake(t.ws,"Mismatched user_ids.",{client_user_ids:n.message.client_user_ids,web_user_ids:n.message.web_user_ids});case"INVALID":return _._terminate_handshake(t.ws,"Could not find nonce with given nonce_key.");case"AUTH_REQUIRED":return _._terminate_handshake(t.ws,"Did not have the necessary authentication to retrieve nonce.");case"LOCAL_INFORMATION_PERMISSION_REQUIRED":return _._terminate_handshake(t.ws,"Did not have permission to start a local-information-allowed connection.")}},error:function(e,n,o){_._terminate_handshake(t.ws,"Unable to retrieve nonce from server",{status:n,error_string:o})}})},e.prototype._terminate_handshake=function(e,t,_){void 0===_&&(_={});var o=n.__assign({message:t},_);u.UNITY_WEB_DEBUG&&console.error(o),this.logger.report_event("unity_failure",o),e&&e.close()},e.prototype._is_connection_in_progress=function(e){return e===p.PENDING||e===p.RETRYING},e.prototype.add_on_open_callback=function(e){this._on_open_callbacks.push(e)},e.prototype.add_on_open_failed_callback=function(e){this._on_open_failed_callbacks.push(e)},e.prototype.add_on_close_callback=function(e){this._on_close_callbacks.push(e)},e.prototype.call_when_ready=function(e,t){return void 0===t&&(t=null),this.is_ready()?e():this._is_connection_in_progress(this._connection_state)?this._pending_callbacks.push({callback:e,error_callback:t}):t?t(i.UnityConnectionError.CONNECTION_CLOSED):void 0},e.prototype.is_ready=function(){return this._webSocket&&this._webSocket.readyState===WebSocket.OPEN&&this._connection_state===p.ESTABLISHED},e.prototype.feature_supported=function(e,t){return void 0===t&&(t=[]),d.assert(null!==this._permission_level,"Connection is not ready."),!(null!==this.client_version&&this.client_version<e)&&t.includes(this._permission_level)},e.SECURE_PERMISSION=E.SECURE_PERMISSION,e.INSECURE_WEB_PERMISSION=E.INSECURE_WEB_PERMISSION,e.INSECURE_CLIENT_PERMISSION=E.INSECURE_CLIENT_PERMISSION,e.INSECURE_PERMISSION=E.INSECURE_PERMISSION,e})();t.UnityConnection=S,t.isUnitySupported=function(){return c.UnityWebSocket.web_sockets_supported()}}),define("modules/clean/unity/connection_error",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e.CONNECTION_TIMEOUT="connection_timeout",e.CONNECTION_CLOSED="connection_closed",e.COULD_NOT_SEND="could_not_send",e.UNEXPECTED_ERROR="unexpected_error"})(t.UnityConnectionError||(t.UnityConnectionError={}))}),define("modules/clean/unity/features",["require","exports","tslib","modules/clean/ajax","modules/clean/filepath","modules/clean/unity/connection","modules/clean/unity/versions","modules/core/exception","modules/core/i18n","modules/core/notify","modules/core/uri"],function(e,t,n,_,o,i,r,s,a,c,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),_=n.__importStar(_),o=n.__importStar(o),r=n.__importDefault(r),s=n.__importStar(s),t.UnityFeatures={_uc:new i.UnityConnection,_has_handshake_started:!1,_cached_file_browser_display_name:null,_start_handshake_if_needed:function(){this._has_handshake_started||(this._uc.start(),this._has_handshake_started=!0)},continue_as_user:function(e,t,n,_){var o=this;return void 0===_&&(_=null),this._start_handshake_if_needed(),this._uc.call_when_ready(function(){if(o._uc.feature_supported(r.default.WEB_DESTINY,[i.UnityConnection.INSECURE_WEB_PERMISSION]))return o._uc.logger.report_event("continue_as_user",{browser:e,refresh_token:t}),o._uc.send("continue_as_user",{browser:e,refresh_token:t},n,_)},_)},continue_as_user_direct:function(e,t){var n=this;return void 0===t&&(t=null),this._start_handshake_if_needed(),this._uc.call_when_ready(function(){if(n._uc.feature_supported(r.default.WEB_DESTINY_V2,[i.UnityConnection.INSECURE_WEB_PERMISSION]))return n._uc.logger.report_event("continue_as_user_direct"),n._uc.send("continue_as_user_direct",null,e,t)},t)},web_destiny_info:function(e,t){var n=this;return void 0===t&&(t=null),this._start_handshake_if_needed(),this._uc.call_when_ready(function(){if(n._uc.feature_supported(r.default.WEB_DESTINY_V2,[i.UnityConnection.INSECURE_WEB_PERMISSION]))return n._uc.logger.report_event("web_destiny_info"),n._uc.send("web_destiny_info",null,e,t)},t)},client_supports_open_in_file_browser:function(){return this._uc.feature_supported(r.default.OPEN_IN_FILE_BROWSER,[i.UnityConnection.SECURE_PERMISSION])},open_file:function(e,t,n,a,c,u){var d=this;void 0===c&&(c=null),void 0===u&&(u=!1),this._start_handshake_if_needed();var h=this.server_path(e,t);return this._uc.call_when_ready(function(){if(d._uc.feature_supported(r.default.UNITY_HANDSHAKE,[i.UnityConnection.SECURE_PERMISSION])){d._uc.logger.report_event("open_file",{user_id:n,path_id:h,file_extension:o.file_extension(h),in_file_browser:u}),_.SilentBackgroundRequest({url:new l.URI({path:"/unity_open_log"}),data:{user_id:n,server_path:h,file_extension:o.file_extension(h),in_file_browser:u,unity_session_id:d._uc.logger.unity_session_id(),buildno:d._uc.logger._data.buildno,host_id:d._uc.logger._data.host_id}});var e={server_path:h,user_id:n};d._uc.client_version>=r.default.OPEN_IN_FILE_BROWSER?e.in_file_browser=u:s.assert(!u,"The connected client doesn't support opening in file browser."),d._uc.send("open_file",e,a,c)}},c)},standard_open_file_handler:function(e){if(!e)return c.Notify.error(a._("Error opening file"))},check_file:function(e,t,n,_,s){var a=this;void 0===s&&(s=null),this._start_handshake_if_needed();var c=this.server_path(e,t),l=function(e){a._check_file_deprecated_on_client()&&(e={is_locally_available:e}),_(e)};this._uc.call_when_ready(function(){if(a._uc.feature_supported(r.default.UNITY_HANDSHAKE,[i.UnityConnection.SECURE_PERMISSION]))return a._uc.logger.report_event("check_file",{user_id:n,path_id:c,file_extension:o.file_extension(c)}),a._uc.send("check_file",{server_path:c,user_id:n},l,s)},s)},add_on_ready_callback:function(e){return this._uc.call_when_ready(e)},check_file_batch:function(e,t,n,_){var s=this;return void 0===_&&(_=null),new Promise(function(a,c){s._start_handshake_if_needed();var l=e.map(function(e){return s.server_path(e.ns_id,e.ns_path)}),u=function(e){if(s._check_file_deprecated_on_client())for(var t in e){var _=e[t];e[t]={is_locally_available:_}}n&&n(e),a(e)},d=function(e){_&&_(e),c(e)};s._uc.call_when_ready(function(){if(s._uc.feature_supported(r.default.UNITY_HANDSHAKE,[i.UnityConnection.SECURE_PERMISSION]))return s._uc.logger.report_event("check_file_batch",{user_id:t,path_ids:l,file_extensions:l.map(o.file_extension)}),s._uc.send("check_file_batch",{server_paths:l,user_id:t},u,d)},d)})},file_browser_display_name:function(e,t){var n=this;if(void 0===t&&(t=null),null!=this._cached_file_browser_display_name)return void e(this._cached_file_browser_display_name);var _=function(t){return n._cached_file_browser_display_name=t,e(t)};this._start_handshake_if_needed();var o=function(){return n._uc.feature_supported(r.default.CHECK_FILE_RETURNS_OBJ,[i.UnityConnection.SECURE_PERMISSION])?(n._uc.logger.report_event("file_browser_display_name"),n._uc.send("file_browser_display_name",null,_,t)):e(null)};return this._uc.call_when_ready(o,t)},_check_file_deprecated_on_client:function(){return r.default.UNITY_HANDSHAKE<=this._uc.client_version&&this._uc.client_version<r.default.CHECK_FILE_RETURNS_OBJ},server_path:function(e,t){return e+":"+t},has_chime:function(e,t){var n=this;void 0===t&&(t=null),this._start_handshake_if_needed();var _=function(){if(n._uc.feature_supported(r.default.CHIME_OPEN,[i.UnityConnection.SECURE_PERMISSION]))return n._uc.logger.report_event("has_chime"),n._uc.send("has_chime",null,e,t)};return this._uc.call_when_ready(_,t)},open_chime:function(e,t,n){var _=this;void 0===n&&(n=null),this._start_handshake_if_needed();var o=function(){if(_._uc.feature_supported(r.default.CHIME_OPEN,[i.UnityConnection.SECURE_PERMISSION]))return _._uc.logger.report_event("open_chime",{parameters:e}),_._uc.send("open_chime",e,t,n)};return this._uc.call_when_ready(o,n)},growth_deep_link:function(e,t){var n=this;return void 0===t&&(t={}),new Promise(function(_,o){n._start_handshake_if_needed(),n._uc.call_when_ready(function(){if(n._uc.feature_supported(r.default.GROWTH_DEEP_LINK,[i.UnityConnection.SECURE_PERMISSION]))return n._uc.logger.report_event("growth_deep_link"),n._uc.send("growth_deep_link",{resource:e,data:t},_,o);o("featured_unsupported")},o)})},isUnitySupported:function(){return i.isUnitySupported()}};var u=i.isUnitySupported()?t.UnityFeatures:void 0;t.default=u}),define("modules/clean/unity/flash_config",["require","exports","tslib","modules/clean/unity/websocket_config","modules/constants/static","modules/constants/unity"],function(e,t,n,_,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=n.__importStar(o),i=n.__importStar(i),window.WEB_SOCKET_DISABLE_AUTO_INITIALIZATION=!0,window.DefaultWebSocket=window.WebSocket,_.WebSocketConfig.useFlashShim()&&(window.WEB_SOCKET_FORCE_FLASH=!0),window.WEB_SOCKET_SWF_LOCATION=o.static_url_web_socket_swf,i.UNITY_WEB_DEBUG||(window.WEB_SOCKET_LOGGER={log:function(){},error:function(){}}),t.default=null}),define("modules/clean/unity/logger",["require","exports","tslib","jquery","modules/clean/ajax","modules/clean/unity/versions","modules/constants/unity","modules/core/uri"],function(e,t,n,_,o,i,r,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),_=n.__importDefault(_),o=n.__importStar(o),i=n.__importDefault(i),r=n.__importStar(r);var a=(function(){function e(){this._data={logging_source:"web",web_unity_version:i.default.LATEST}}return e.prototype.update=function(e){return _.default.extend(this._data,e)},e.prototype.report_event=function(e,t){if(void 0===t&&(t=null),this._data.event_name=e,this._data.local_ts=(new Date).getTime()/1e3,this._data.extra=JSON.stringify(t||{}),o.SilentBackgroundRequest({url:new s.URI({path:"/unity_connection_log"}),data:this._data}),r.UNITY_WEB_DEBUG)return console.log(this._data)},e.prototype.get_log_data_for_client=function(){return{web_unity_version:this._data.web_unity_version,user_agent:window.navigator.userAgent}},e.prototype.unity_session_id=function(){return this._data.unity_session_id},e})();t.default=a}),define("modules/clean/unity/versions",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e[e.LATEST=15]="LATEST",e[e.INITIAL_UNITY=1]="INITIAL_UNITY",e[e.UNITY_HANDSHAKE=2]="UNITY_HANDSHAKE",e[e.REUNITY=3]="REUNITY",e[e.OPEN_IN_FILE_BROWSER=4]="OPEN_IN_FILE_BROWSER",e[e.CHECK_FILE_RETURNS_OBJ=5]="CHECK_FILE_RETURNS_OBJ",e[e.PERMISSION_LEVELS=6]="PERMISSION_LEVELS",e[e.WEB_DESTINY=7]="WEB_DESTINY",e[e.WEB_DESTINY_V2=8]="WEB_DESTINY_V2",e[e.PORT_CHECK=9]="PORT_CHECK",e[e.CHIME_OPEN=10]="CHIME_OPEN",e[e.GROWTH_DEEP_LINK=15]="GROWTH_DEEP_LINK"})(n||(n={})),t.default=n}),define("modules/clean/unity/web_socket",["require","exports","tslib","external/web_socket","modules/clean/unity/logger","modules/clean/unity/websocket_config"],function(e,t,n,_,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),_=n.__importDefault(_),o=n.__importDefault(o);t.UnityWebSocket={create:function(e){return"function"==typeof _.default.__initialize&&_.default.__initialize(),new _.default(e)},load_flash_policy_if_needed:function(){var e=new o.default;if(_.default&&_.default.loadFlashPolicyFile)e.report_event("load_flash_policy_file"),_.default.loadFlashPolicyFile("xmlsocket://127.0.0.1:17603");else{if(i.WebSocketConfig.useFlashShim())return e.report_event("unity_failure",{message:"Could not use WebSockets."}),!1;e.report_event("using_default_web_socket")}return!0},web_sockets_supported:function(){return!!_.default}}}),define("modules/clean/unity/websocket_config",["require","exports","tslib","external/flash_detect","modules/core/browser_detection"],function(e,t,n,_,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),_=n.__importDefault(_),o=n.__importStar(o),t.WebSocketConfig={useFlashShim:function(){return this.canFlashPolyfillWebSocket()&&!this.canBrowserSupportNonSecureWebsocket()},canUnityConnect:function(){return this.canFlashPolyfillWebSocket()||this.canBrowserSupportNonSecureWebsocket()},canFlashPolyfillWebSocket:function(){return _.default.versionAtLeast(10,3)},canBrowserSupportNonSecureWebsocket:function(){var e=parseInt(o.version,10);return!!(o.safari&&e<9)||!!(o.chrome&&e>=53)}},t.default=t.WebSocketConfig});
//# sourceMappingURL=pkg-unity.min.js-vflaEvAxA.map